<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Holiday Atlas — National Holidays Map</title>

    <link rel="stylesheet" href="/styles.css" />

    <script src="https://code.highcharts.com/maps/highmaps.js" defer></script>
    <script src="https://code.highcharts.com/modules/exporting.js" defer></script>
    <script src="https://code.highcharts.com/modules/accessibility.js" defer></script>
    <script type="module" src="/app.js"></script>
    <script src="/busy-calendar.js" defer></script>

  </head>
  <body>
    <header>
      <div class="brand">Holiday Atlas — Interactive Map of National Holidays</div>
    </header>

    <div class="layout">
      <aside class="menu">
        <h2 class="menu-title">
          Holiday Atlas <span id="menu-year"></span>
        </h2>
        <nav class="menu-nav" aria-label="Page sections">
          <a class="menu-link" href="#interactive-map">Global map of national holidays</a>
          <a class="menu-link" href="#most">Countries with the Most Holidays</a>
          <a class="menu-link" href="#busy">World Holiday Calendar (Busiest Dates)</a>
          <a class="menu-link" href="#month">Holidays by Month & Season</a>
          <a class="menu-link" href="#day">Weekday Patterns</a>
          <a class="menu-link" href="#universal">Shared Global Holidays</a>
          <a class="menu-link" href="#long-weekend">Long-Weekend Frequency by Country</a>
          <a class="menu-link" href="#religious">Religious vs Public Overlap</a>
          <a class="menu-link" href="#independance">Independence & Liberation Days (Monthly Clusters)</a>     
        </nav>
      </aside>

      <main class="main">
        <section id="interactive-map" class="section">
          <div class="view-tags" role="tablist" aria-label="Map views">
            <button class="view-tag is-active" role="tab" aria-selected="true" data-view="all">All Year</button>
            <button class="view-tag" role="tab" aria-selected="false" data-view="today">Today</button>
            <button class="view-tag" role="tab" aria-selected="false" data-view="next7">Next 7 days</button>
            <button class="view-tag" role="tab" aria-selected="false" data-view="next30">Next 30 days</button>
          </div>

          <div class="map-wrap">
            <div id="wpr-map" role="img" aria-label="Choropleth map of national holidays"></div>
            <article id="details" class="card">
              <div class="details-header">
                <strong id="details-title">National Holidays</strong>
                <div class="details-views" role="tablist" aria-label="Detail views">
                  <button id="details-view-list" class="details-view is-active" role="tab" aria-selected="true">List</button>
                  <button id="details-view-cal" class="details-view" role="tab" aria-selected="false">Calendar</button>
                </div>
              </div>
              <div id="details-body"></div>
            </article>
          </div>

          <div id="region-list-anchor"></div>
          <div id="view-loading" class="loading-chip" hidden>Loading</div>
          <section id="holiday-country-list" class="country-panel hidden" aria-live="polite"></section>
        </section>
        
        <section id="most" class="card">
          <h2>Countries with the Most Holidays</h2>
          <div class="table-wrap">
            <table id="holiday-table">
              <thead>
                <tr>
                  <th scope="col" class="sortable" data-key="country" data-type="string" aria-sort="none">
                    COUNTRY
                    <span class="sort-indicator" aria-hidden="true"></span>
                  </th>
                  <th scope="col" class="num sortable" data-key="holidays" data-type="number" aria-sort="descending">
                    # OF PUBLIC HOLIDAYS
                    <span class="sort-indicator" aria-hidden="true"></span>
                  </th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </section>

        <section id="busy" class="section">
          <div class="card">
            <div class="section-head">
              <h2 class="section-title">World Holiday Calendar — Busiest Dates</h2>
              <div class="section-subtitle">Same calendar layout; each date is colored by how many countries celebrate that day.</div>
            </div>

            <!-- Legend -->
            <div class="cal-legend">
              <div class="cal-legend__scale" role="img" aria-label="Color scale from fewer to more holidays"></div>
              <div class="cal-legend__ticks"><span>0</span><span>1</span><span>5</span><span>10</span><span>20</span><span>40+</span></div>
            </div>

            <!-- 12 month cards (same structure/naming as your country calendar) -->
            <div class="year-cal">
              <!-- Repeat this month block 12x; JS will fill days -->
              <section class="cal-month" aria-label="January">
                <header class="cal-month__head">
                  <h3 class="cal-month__name">January 2025</h3>
                  <div class="cal-dow">S M T W T F S</div>
                </header>
                <div class="cal-grid" role="grid">
                  <!-- JS inserts <button class="cal-day heat-bX" data-count="…" title="…"><span class="cal-day__num">1</span></button> -->
                </div>
              </section>

              <!-- … February → December blocks (same markup, empty .cal-grid) … -->
            </div>

            <!-- Tooltip (optional; JS positions/updates) -->
            <div id="busy-tip" class="heat-tip" hidden></div>
          </div>
        </section>

        <section id="month">
          <h2>Holidays by Month/Season</h2>
          <p>…content…</p>
        </section>

        <section id="day">
          <h2>Which Days of the Week Dominate?</h2>
          <p>…content…</p>
        </section>

        <section id="universal">
          <h2>Universal Holidays</h2>
          <p>…content…</p>
        </section>

        <section id="long-weekend">
          <h2>Long-Weekend Frequency by Country</h2>
          <p>…content…</p>
        </section>

        <section id="religious">
          <h2>Religious vs Public Holiday Overlap</h2>
          <p>…content…</p>
        </section>

        <section id="independance">
          <h2>Independence/Liberation Days by Country (Monthly Clusters)</h2>
          <p>…content…</p>
        </section>
      </main>
    </div>

    <script>
      // Smooth in-page scroll (safe even if target section doesn't exist)
      document.addEventListener('click', (e) => {
        const a = e.target.closest('a[href^="#"]');
        if (!a) return;
        const el = document.querySelector(a.getAttribute('href'));
        if (!el) return;
        e.preventDefault(); el.scrollIntoView({ behavior: 'smooth', block: 'start' });
        history.replaceState(null, '', a.getAttribute('href'));
      });

      // Year badge inside the left menu title
      (function () {
        const y = new URLSearchParams(location.search).get('year');
        const YEAR = Number.isInteger(+y) && +y >= 1900 && +y <= 2100 ? +y : (new Date()).getFullYear();
        const badge = document.getElementById('menu-year');
        if (badge) badge.textContent = ` ${YEAR}`;
      })();
    </script>
  </body>
</html>
